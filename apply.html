<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>📝 Apply for a Loan - MoneyMarket</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>📝 Loan Application</h1>
    <p>Fill out the form below to apply for a personal loan.</p>
  </header>

  <nav>
    <a href="index.html">🏠 Home</a>
    <a href="about.html">ℹ️ About</a>
    <a href="calculator.html">🧮 Calculator</a>
    <a href="apply.html">📝 Apply</a>
    <a href="contact.html">📞 Contact</a>
  </nav>

  <section>
    <h2>📄 Loan Application Form</h2>

    <!-- Use JS fetch to Netlify Function instead of Formspree -->
    <form id="loanForm">
      <label>👤 Full Name</label>
      <input type="text" name="name" required />

      <label>🏢 Company Name</label>
      <input type="text" name="company" />

      <label>📧 Email Address</label>
      <input type="email" name="email" required />

      <label>📞 Phone Number</label>
      <input type="tel" name="phone" required />

      <label>🏙️ City</label>
      <input type="text" name="city" required />

      <label>📮 Pincode</label>
      <input type="text" name="pincode" pattern="\d{6}" maxlength="6" placeholder="Postal Code" required />
      
      <label>💵 Loan Amount</label>
      <input type="number" name="loanAmount" required />

      <label>🎯 Loan Purpose</label>
      <select name="loanPurpose" required>
        <option value="">-- Select Purpose --</option>
        <option>Debt Consolidation</option>
        <option>Home Improvement</option>
        <option>Medical Expenses</option>
        <option>Education</option>
        <option>Other</option>
      </select>

      <label>💰 Monthly Income</label>
      <input type="number" name="monthlyIncome" required />

      <label>📊 Credit Score</label>
      <select name="creditScore" required>
        <option value="">-- Select Credit Score --</option>
        <option>Excellent (720+)</option>
        <option>Good (660–719)</option>
        <option>Fair (600–659)</option>
        <option>Poor (&lt;600)</option>
      </select>

      <label>🗒️ Additional Notes</label>
      <textarea name="message" rows="4"></textarea>

      <button type="submit">🚀 Submit Application</button>
    </form>
  </section>

  <footer>
    <p>&copy; 2025 MoneyMarket. All rights reserved.</p>
    <p><strong>📍 Address:</strong> Square Trade, Sakinaka, Andheri (East), Mumbai - 400072</p>
    <p><strong>📧 Email:</strong> support@moneymarket.com &nbsp;&nbsp; <strong>📞 Phone:</strong> 1-800-555-LOAN</p>
  </footer>

  <script>
    const loanForm = document.getElementById("loanForm");
    loanForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = Object.fromEntries(new FormData(loanForm));

      try {
        const res = await fetch("/.netlify/functions/sendEmail", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData),
        });

        const result = await res.json();

        if (res.ok) {
          alert("✅ Application submitted successfully!");
          loanForm.reset();
        } else {
          alert("❌ Failed: " + (result.error || "Something went wrong"));
        }
      } catch (err) {
        alert("❌ Failed to send application. Try again later.");
        console.error(err);
      }
    });
  </script>
</body>
</html>

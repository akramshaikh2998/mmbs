<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“ Apply for a Loan - MoneyMarket</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ğŸ“ Loan Application</h1>
    <p>Fill out the form below to apply for a personal loan.</p>
  </header>

  <nav>
    <a href="index.html">ğŸ  Home</a>
    <a href="about.html">â„¹ï¸ About</a>
    <a href="calculator.html">ğŸ§® Calculator</a>
    <a href="apply.html">ğŸ“ Apply</a>
    <a href="contact.html">ğŸ“ Contact</a>
  </nav>

  <section>
    <h2>ğŸ“„ Loan Application Form</h2>

    <!-- Use JS fetch to Netlify Function instead of Formspree -->
    <form id="loanForm">
      <label>ğŸ‘¤ Full Name</label>
      <input type="text" name="name" required />

      <label>ğŸ¢ Company Name</label>
      <input type="text" name="company" />

      <label>ğŸ“§ Email Address</label>
      <input type="email" name="email" required />

      <label>ğŸ“ Phone Number</label>
      <input type="tel" name="phone" required />

      <label>ğŸ™ï¸ City</label>
      <input type="text" name="city" required />

      <label>ğŸ“® Pincode</label>
      <input type="text" name="pincode" pattern="\d{6}" maxlength="6" placeholder="Postal Code" required />
      
      <label>ğŸ’µ Loan Amount</label>
      <input type="number" name="loanAmount" required />

      <label>ğŸ¯ Loan Purpose</label>
      <select name="loanPurpose" required>
        <option value="">-- Select Purpose --</option>
        <option>Debt Consolidation</option>
        <option>Home Improvement</option>
        <option>Medical Expenses</option>
        <option>Education</option>
        <option>Other</option>
      </select>

      <label>ğŸ’° Monthly Income</label>
      <input type="number" name="monthlyIncome" required />

      <label>ğŸ“Š Credit Score</label>
      <select name="creditScore" required>
        <option value="">-- Select Credit Score --</option>
        <option>Excellent (720+)</option>
        <option>Good (660â€“719)</option>
        <option>Fair (600â€“659)</option>
        <option>Poor (&lt;600)</option>
      </select>

      <label>ğŸ—’ï¸ Additional Notes</label>
      <textarea name="message" rows="4"></textarea>

      <button type="submit">ğŸš€ Submit Application</button>
    </form>
  </section>

  <footer>
    <p>&copy; 2025 MoneyMarket. All rights reserved.</p>
    <p><strong>ğŸ“ Address:</strong> Square Trade, Sakinaka, Andheri (East), Mumbai - 400072</p>
    <p><strong>ğŸ“§ Email:</strong> support@moneymarket.com &nbsp;&nbsp; <strong>ğŸ“ Phone:</strong> 1-800-555-LOAN</p>
  </footer>

  <script>
    const loanForm = document.getElementById("loanForm");
    loanForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = Object.fromEntries(new FormData(loanForm));

      try {
        const res = await fetch("/.netlify/functions/sendEmail", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData),
        });

        const result = await res.json();

        if (res.ok) {
          alert("âœ… Application submitted successfully!");
          loanForm.reset();
        } else {
          alert("âŒ Failed: " + (result.error || "Something went wrong"));
        }
      } catch (err) {
        alert("âŒ Failed to send application. Try again later.");
        console.error(err);
      }
    });
  </script>
</body>
</html>
